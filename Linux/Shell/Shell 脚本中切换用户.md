在 Shell 脚本中，会遇到切换到其他用户执行命令的情况，甚至，使用某个无权登录的用户执行命令。此时可以使用`su`命令来切换，但在 Shell 脚本中，会有一些其他的需要注意的地方。

> `su`命令一般用于切换登录用户，比如使用`su root`就可以从当前用户切换到`root`用户，使用`root`账户来登录系统。
> 
> 如果切换到指定的用户需要验证，那么就需要输入密码以便完成切换。所以一般情况下，会在当前用户是`root`的时候使用。

### 1. 不切换用户，使用指定用户执行命令：

```shell
su - username -c "command"
```
    
这表示，切换到用户`username`的登录状态，并执行命令`command`，执行完成之后，切换回当前的用户。

### 2. 不重置登录环境指定用户执行命令：
    
```shell
su -m username -c 'command'
```
    
这种和上面基本相同，不同的地方在于，这种方式可以使用不能登录系统的用户来执行命令。
    
### 3. 批量执行命令

如果需要切换用户，然后执行多个命令，使用`-c`选项可能就不太方便，此时可以使用 heredoc 方式来写多条命令进行执行。
    
```shell
su - username <<<!
command1
command2
...
exit
!
```
    
这表示，切换命令之后，执行相关命令，执行完成之后，使用`exit`命令退出到原来的用户。



