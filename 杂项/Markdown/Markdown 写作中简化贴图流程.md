markdown 写作的时候，图片插入是一件比较麻烦的事情。常见的流程如下：

- 用截图工具截图；
- 将截图保存到某个地方
- 修改截图文件名
- 上传截图到某个图床（如果不用“围脖是个好图床”这样的工具，还得用客户端登陆）
- 拿到图床上的截图的链接；然后用markdown格式插入图片

这么复杂的流程，让人简直没有了插入图片的欲望；但是大量的文字没有图片，必然让人疲惫；要是能随便截个图，然后直接粘贴就成了markdown格式就好了；自然是能够做到！懒就是生产力～

使用[`markdown-img-upload`](https://github.com/tiann/markdown-img-upload)就能很方便的将图片快速上传到图床，并得到对应的引用链接了。

## 预览
预览效果如下：

![预览效果](http://cnd.qiniu.lin07ux.cn/markdown/1463411070326.png)

第一步，截图；第二步，粘贴；done!

还可以直接拷贝图片，然后一步上传：

![极速本地图片转图片链接](http://cnd.qiniu.lin07ux.cn/markdown/1463446291131.png)


## 特性

- 直接将图片粘贴为 markdown 支持的图片链接
- 支持 retina 的截图处理，在非 retina 的显示器上不会变大
- 自动图片上传，失败通知栏通知
- 支持多种截图格式，压缩过大图片
- 方便的图片上传工具

## 安装

### 1. 安装依赖
由于七牛 SDK 使用了 Python 的`requests`库进行网络请求，所以首先得安装这个库；推荐使用 pip 进行安装：

```shell
# MacOS
sudo easy_install pip
sudo pip install requests
```

> 注意：是requests库，而不是request库，安装错误则无法正常使用。

### 2. 获取七牛图床信息
如果没有七牛账号，可以先 [注册](http://www.qiniu.com)。

找到自己七牛账户中的：域名、空间名、Access Key、Secret Key，后面会需要用到。

### 3. 安装 Alfred 工作流

- 首先请确认`request`库安装成功；
- 然后下载并导入项目目录中的 Alfred 工作流文件；
- 设置触发热键，如`Cmd + Ctrl + V`，注意不要与其他软件的热键冲突。

### 4. 配置图床信息
在前面图床的信息拿到之后，在 alfred 中输入`mdimgsetup`命令，可以打开一个文本文档，如下：

![配置图床信息](http://cnd.qiniu.lin07ux.cn/markdown/1463446782382.png)

在这个文档中，设置你的七牛图床的信息，`AK`，`SK`是访问密钥，`url`是上面配置的图床访问地址，`bucket`是空间名字，`prefix`是图床上传的前缀，这个可以随意配置，作为分类使用，比如我的是 markdown。


## 使用
经过上面的配置，就可以正常使用一键上传图片到七牛空间了。

### 1. 截图上传
使用任意截图工具截图之后，在任意编辑器里面你需要插入 markdown 格式图片的地方，按下`Cmd + Ctrl + V`(或者你设置的其他的快捷键)即可！

另外，markdwon 里面的图片链接不是标准的 markdown 格式，而是 html 的 img 标签。
这是因为在 retina 屏幕下截图的话，如果不做任何处理，在非 retina 屏幕下面，这个图片会直接扩大两倍，非常粗糙难看；因此，需要保存图片显示大小的信息，保证截图大小和显示大小一致；这里使用 Mac 系统自带的 sips 工具拿到截图大小，然后直接把宽度放在 img 标签里面。这样在显示的时候，可以保证是和截图时大小一致。

### 2. 通过本地图片上传
如果你已经有一张图片了，希望上传到图床得到一个链接，通过这个 alfred 插件，可以直接复制本地图片，然后按下`Cmd + Ctrl + V`(或者你设置的其他的快捷键)就能得到图床的链接！
