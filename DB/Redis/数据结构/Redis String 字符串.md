### 1. 数据结构

Redis 使用`sdshdr`结构来表示一个 SDS 值：

```c
struct sdshdr{

    // 字节数组，用于保存字符串
    char buf[];

    // 记录 buf 数组中已使用的字节数量，也是字符串的长度
    int len;

    // 记录 buf 数组未使用的字节数量
    int free;
}
```

示意图：

![](http://cnd.qiniu.lin07ux.cn/markdown/1558799609988.png)

### 2. 特点

SDS 与 C 的字符串表示比较，好处如下：

1.	sdshdr 数据结构中用`len`属性记录了字符串的长度。那么获取字符串的长度时，时间复杂度只需要`O(1)`。
2.	SDS **不会发生溢出**的问题，如果修改 SDS 时，空间不足。先会扩展空间，再进行修改！(内部实现了**动态扩展**机制)。
3.	SDS 可以**减少内存分配的次数** (空间预分配机制)。在扩展空间时，除了分配修改时所必要的空间，还会分配额外的空闲空间(free 属性)。
4.	SDS 是**二进制安全**的 ，所有 SDS API 都会以处理二进制的方式来处理 SDS 存放在 buf 数组里的数据。


